@using BlackMesa.Models
@model BlackMesa.Models.Entry

@{
    ViewBag.Title = Model.Title;
}

<section id="entry-details">

    @Html.Partial("_EntryPreview", Model)
    
    <div id="disqus_thread"></div>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    @*
    @Html.Partial("Comment/_Index", Model.Comments)

    @Html.Partial("Comment/_Create", new Comment{ EntryId = Model.Id } )
    *@

</section>

@section Scripts
{

    <script type="text/javascript">
        $(function () {
            
            /* SyntaxHighlighter */

            SyntaxHighlighter.autoloader(
                'js jscript javascript            /Scripts/shBrushes/shBrushJScript.js',
                'c-sharp, csharp	                /Scripts/shBrushes/shBrushCSharp.js',
                'ps, powershell	                /Scripts/shBrushes/shBrushPowerShell.js',
                'xml, xhtml, xslt, html, xhtml	/Scripts/shBrushes/shBrushXml.js',
                'sql                              /Scripts/shBrushes/shBrushSql.js',
                'bash, shell	                    /Scripts/shBrushes/shBrushBash.js',
                'plain, text	                    /Scripts/shBrushes/shBrushPlain.js'
            );

            var elementsToBeHighlighted = SyntaxHighlighter.findElements().length,
                highlightedElements = 0;

            SyntaxHighlighter.complete = function(callback) {

                (function recountHighlightedElements() {
                    setTimeout(function() {
                        highlightedElements = $('.syntaxhighlighter');
                        if (highlightedElements.length < elementsToBeHighlighted) {
                            recountHighlightedElements();
                        } else {
                            callback();
                        }
                    }, 200);
                })();
            };

            SyntaxHighlighter.complete(function() {
                $(".syntaxhighlighter").parent().addClass("sh-padding-right");
            });
                
            SyntaxHighlighter.all();
        });
        
        /* Disqus */

        var disqus_shortname = 'blackmesa';
        var disqus_identifier = '@Model.Id';
        var disqus_title = '@Model.Title';
        var disqus_url = '@Url.Action("Details", "Entry", new { id=Model.Id }, Request.Url.Scheme)';
        
        (function () {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

    </script>
    

}
